---
title: "Spotify and Billboard Data"
author: "Lucero Mejia, Jason Yan, Shea Frantz, Schawnery Lin"
date: "February 22, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("knitr")
source("analysis.R")
source("billboard_data.R")
year <- "2015"
```

## Section 3: Preliminary Analysis

This section focuses on further analyzing each data set, providing descriptive statistics and comparative analysis for major features in data sets. 

### First data set: list of Billboard top songs

The following analysis is about Billboard top songs, including 
The table below is an example of Billboard `r year` top songs, which includes song title, artist name, number of words, and genre for each track.

``` {r billboard data, echo = FALSE}
billboard_songs <- get_year(year)
kable(billboard_songs, col.names = c("Song Title", "Artist", "Number of Words", "Genre"))
```

### Second data set: Spotify data for Billboard `r year` top songs

The following analysis is about spotify data of Billboard top songs, including the name for each track, the duration of the track, and the popularity of the track.

```{r spotify data, echo = FALSE}
spotify_year_data <- spotify_data(billboard_songs)
spotify_data_summary <- spotify_year_data %>% 
  summarize(max_popularity = max(popularity), avg_popularity = round(mean(popularity)), avg_duration_in_minute = round(mean(duration_ms)/60000, 2))
max_popularity <- pull(spotify_data_summary, max_popularity)
avg_popularity <- pull(spotify_data_summary, avg_popularity)
avg_duration_in_minute <- pull(spotify_data_summary, avg_duration_in_minute)
kable(spotify_year_data)
```

For Billboard `r year` top songs, the greatest popularity is `r max_popularity`, average popularity of the track is `r avg_popularity`, and average duration of the track is `r avg_duration_in_minute` minutes.

### Combined data set



```{r combined data, echo = FALSE}
combined_data <- combined_data_frames(billboard_songs)
kable(combined_data)
```
